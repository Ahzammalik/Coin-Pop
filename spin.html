<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lucky Spin - Coin Pop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .wheel-container { position: relative; width: 320px; height: 320px; margin: 0 auto; }
        #wheel { width: 100%; height: 100%; border-radius: 50%; border: 8px solid #1e293b; transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1); background: conic-gradient(#6366f1 0deg 45deg, #a855f7 45deg 90deg, #6366f1 90deg 135deg, #a855f7 135deg 180deg, #6366f1 180deg 225deg, #a855f7 225deg 270deg, #6366f1 270deg 315deg, #a855f7 315deg 360deg); }
        .pointer { position: absolute; top: -20px; left: 50%; transform: translateX(-50%); width: 40px; height: 40px; background: #ef4444; clip-path: polygon(50% 100%, 0 0, 100% 0); z-index: 10; }
    </style>
</head>
<body class="bg-slate-50">
    <main class="main-content flex flex-col items-center justify-center min-h-screen" style="margin-left:0;">
        <h1 class="text-4xl font-black text-slate-800 mb-10">Lucky Spin</h1>
        
        <div class="wheel-container mb-12">
            <div class="pointer"></div>
            <div id="wheel"></div>
        </div>

        <button onclick="spinWheel()" id="spin-btn" class="bg-indigo-600 text-white px-16 py-5 rounded-2xl font-black text-2xl shadow-2xl hover:bg-indigo-700 active:scale-95 transition">
            SPIN FOR 10 COINS
        </button>
        
        <a href="dashboard.html" class="mt-8 text-slate-400 font-bold hover:text-indigo-600">Back to Dashboard</a>
    </main>

    <script>
        let user = JSON.parse(localStorage.getItem('currentUser'));
        let spinning = false;

        function spinWheel() {
            if(spinning || user.coins < 10) {
                alert("Not enough coins or already spinning!");
                return;
            }

            spinning = true;
            user.coins -= 10; // Fee for spinning
            
            const randomDeg = Math.floor(Math.random() * 360) + 3600; // 10 rotations + random
            const wheel = document.getElementById('wheel');
            wheel.style.transform = `rotate(${randomDeg}deg)`;

            setTimeout(() => {
                spinning = false;
                const win = 20; // Fixed reward for this example, can be randomized
                user.coins += win;
                localStorage.setItem('currentUser', JSON.stringify(user));
                localStorage.setItem(`user_${user.email}`, JSON.stringify(user));
                alert(`You won ${win} Coins!`);
                location.reload();
            }, 4000);
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play Game - Coin Pop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        #game-box { height: 500px; background: #0f172a; border-radius: 2.5rem; position: relative; overflow: hidden; border: 5px solid #334155; cursor: crosshair; }
        .target { position: absolute; width: 65px; height: 65px; background: radial-gradient(circle, #fcd34d, #d97706); border-radius: 50%; border: 4px solid #fff; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px #fbbf24; animation: pop 0.3s ease-out; }
        @keyframes pop { 0% { transform: scale(0); } 100% { transform: scale(1); } }
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="p-8 text-white font-black text-2xl italic">COIN POP</div>
        <nav>
            <a href="dashboard.html" class="nav-link"><i class="fas fa-th-large mr-3"></i> Dashboard</a>
            <a href="play.html" class="nav-link active"><i class="fas fa-gamepad mr-3"></i> Play Games</a>
            <a href="rewards.html" class="nav-link"><i class="fas fa-gift mr-3"></i> Daily Rewards</a>
        </nav>
    </aside>

    <main class="main-content">
        <div class="flex justify-between items-center mb-6">
            <div id="lives" class="text-2xl">‚ù§‚ù§‚ù§</div>
            <div class="text-xl font-bold text-indigo-600">Session Score: <span id="score">0</span></div>
        </div>

        <div id="game-box" onclick="miss(event)">
            <div id="overlay" class="absolute inset-0 bg-slate-900/90 flex flex-col items-center justify-center z-50">
                <h2 class="text-white text-4xl font-black mb-6">READY TO POP?</h2>
                <button onclick="start()" class="bg-indigo-500 text-white px-12 py-4 rounded-2xl font-bold shadow-2xl hover:bg-indigo-600">START MATCH</button>
            </div>
        </div>
    </main>

    <script>
        let user = JSON.parse(localStorage.getItem('currentUser'));
        let score = 0, lives = 3, active = false;

        function start() {
            document.getElementById('overlay').style.display = 'none';
            active = true; lives = 3; score = 0; spawn();
        }

        function spawn() {
            if(!active) return;
            const box = document.getElementById('game-box');
            const old = document.querySelector('.target'); if(old) old.remove();
            
            const t = document.createElement('div');
            t.className = 'target';
            t.style.left = Math.random() * (box.clientWidth - 70) + 'px';
            t.style.top = Math.random() * (box.clientHeight - 70) + 'px';
            t.innerHTML = '<i class="fas fa-coins text-white"></i>';
            
            t.onpointerdown = (e) => {
                e.stopPropagation();
                score += 5;
                user.coins += 5;
                localStorage.setItem('currentUser', JSON.stringify(user));
                document.getElementById('score').innerText = score;
                spawn();
            };
            box.appendChild(t);
        }

        function miss(e) {
            if(!active || e.target.id !== 'game-box') return;
            lives--;
            let l = ''; for(let i=0; i<3; i++) l += i < lives ? '‚ù§' : 'üñ§';
            document.getElementById('lives').innerText = l;
            if(lives <= 0) { active = false; alert("Game Over! Score: " + score); location.reload(); }
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>History - Coin Pop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-slate-50">
    <div class="sidebar hidden md:block">
        <div class="p-8 text-white font-black text-2xl italic">COIN POP</div>
        <nav class="px-4 space-y-2">
            <a href="dashboard.html" class="nav-link"><i class="fas fa-th-large mr-3"></i> Dashboard</a>
            <a href="history.html" class="nav-link active"><i class="fas fa-history mr-3"></i> History</a>
        </nav>
    </div>

    <main class="main-content">
        <h1 class="text-3xl font-black text-slate-800 mb-8">Transaction History</h1>
        
        <div id="history-list" class="space-y-4">
            </div>
    </main>

    <script>
        const user = JSON.parse(localStorage.getItem('currentUser'));
        const history = JSON.parse(localStorage.getItem('withdraw_requests')) || [];
        const list = document.getElementById('history-list');

        const userHistory = history.filter(h => h.email === user.email);

        if(userHistory.length === 0) {
            list.innerHTML = `<div class="bg-white p-10 rounded-3xl text-center text-slate-400 font-bold border-2 border-dashed">No transactions yet.</div>`;
        } else {
            userHistory.reverse().forEach(item => {
                const statusColor = item.status === 'Approved' ? 'text-green-500' : (item.status === 'Rejected' ? 'text-red-500' : 'text-orange-500');
                list.innerHTML += `
                    <div class="bg-white p-6 rounded-3xl shadow-sm border flex justify-between items-center">
                        <div>
                            <p class="font-black text-slate-800 text-lg">Withdraw via ${item.method}</p>
                            <p class="text-slate-400 text-sm font-bold">${item.date}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-black text-xl text-indigo-600">-${item.amount} Coins</p>
                            <p class="font-bold text-xs uppercase ${statusColor}">${item.status}</p>
                        </div>
                    </div>
                `;
            });
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel - Coin Pop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-slate-900 text-white">
    <div class="p-10 max-w-6xl mx-auto">
        <div class="flex justify-between items-center mb-10">
            <h1 class="text-4xl font-black italic tracking-tighter text-indigo-400">ADMIN CONTROL</h1>
            <button onclick="location.reload()" class="bg-slate-800 p-3 rounded-xl"><i class="fas fa-sync"></i> Refresh</button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
            <div class="bg-slate-800 p-6 rounded-3xl border border-slate-700">
                <p class="text-slate-400 font-bold uppercase text-xs">Total Requests</p>
                <h2 id="total-req" class="text-3xl font-black mt-2">0</h2>
            </div>
            <div class="bg-slate-800 p-6 rounded-3xl border border-slate-700">
                <p class="text-slate-400 font-bold uppercase text-xs">Pending Amount</p>
                <h2 id="pending-amt" class="text-3xl font-black mt-2 text-orange-400">0</h2>
            </div>
        </div>

        <div class="bg-slate-800 rounded-[2rem] overflow-hidden border border-slate-700">
            <table class="w-full text-left">
                <thead class="bg-slate-700/50 text-slate-400 uppercase text-sm">
                    <tr>
                        <th class="p-6">User Email</th>
                        <th class="p-6">Method</th>
                        <th class="p-6">Amount</th>
                        <th class="p-6">Status</th>
                        <th class="p-6 text-center">Action</th>
                    </tr>
                </thead>
                <tbody id="request-list">
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        function loadRequests() {
            const requests = JSON.parse(localStorage.getItem('withdraw_requests')) || [];
            const list = document.getElementById('request-list');
            let totalAmt = 0;
            list.innerHTML = '';

            requests.forEach((req, index) => {
                if(req.status === 'Pending') totalAmt += parseInt(req.amount);
                
                list.innerHTML += `
                    <tr class="border-t border-slate-700">
                        <td class="p-6 font-bold">${req.email}</td>
                        <td class="p-6">${req.method} (${req.account})</td>
                        <td class="p-6 text-indigo-400 font-black">${req.amount} Coins</td>
                        <td class="p-6"><span class="px-3 py-1 bg-orange-500/20 text-orange-400 rounded-full text-xs font-bold">${req.status}</span></td>
                        <td class="p-6 text-center">
                            <button onclick="updateStatus(${index}, 'Approved')" class="bg-green-600 px-4 py-2 rounded-lg text-xs font-bold mr-2 hover:bg-green-700">Approve</button>
                            <button onclick="updateStatus(${index}, 'Rejected')" class="bg-red-600 px-4 py-2 rounded-lg text-xs font-bold hover:bg-red-700">Reject</button>
                        </td>
                    </tr>
                `;
            });

            document.getElementById('total-req').innerText = requests.length;
            document.getElementById('pending-amt').innerText = totalAmt.toLocaleString();
        }

        function updateStatus(index, newStatus) {
            let requests = JSON.parse(localStorage.getItem('withdraw_requests'));
            requests[index].status = newStatus;
            localStorage.setItem('withdraw_requests', JSON.stringify(requests));
            
            // Add to Global History for the user to see
            let history = JSON.parse(localStorage.getItem('global_history')) || [];
            history.push(requests[index]);
            localStorage.setItem('global_history', JSON.stringify(history));
            
            alert(`Request ${newStatus}!`);
            loadRequests();
        }

        loadRequests();
    </script>
</body>
</html>
<aside class="sidebar">
    <div class="px-8 py-6 mb-4">
        <h1 class="text-white font-black text-2xl italic">COIN POP</h1>
    </div>
    
    <nav class="flex flex-col flex-grow">
        <a href="dashboard.html" class="nav-link"><i class="fas fa-th-large mr-3"></i> Dashboard</a>
        <a href="play.html" class="nav-link"><i class="fas fa-gamepad mr-3"></i> Play Games</a>
        <a href="spin.html" class="nav-link"><i class="fas fa-dharmachakra mr-3"></i> Lucky Spin</a>
        <a href="rewards.html" class="nav-link"><i class="fas fa-gift mr-3"></i> Daily Rewards</a>
        
        <div class="h-px bg-slate-700 my-4 mx-6"></div>

        <a href="leaderboard.html" class="nav-link"><i class="fas fa-trophy mr-3"></i> Leaderboard</a>
        <a href="withdraw.html" class="nav-link"><i class="fas fa-wallet mr-3"></i> Withdraw</a>
        <a href="history.html" class="nav-link"><i class="fas fa-history mr-3"></i> History</a>
        
        <div class="h-px bg-slate-700 my-4 mx-6"></div>

        <a href="profile.html" class="nav-link"><i class="fas fa-user-circle mr-3"></i> My Profile</a>
        <a href="settings.html" class="nav-link"><i class="fas fa-cog mr-3"></i> Settings</a>
        <a href="contact.html" class="nav-link"><i class="fas fa-headset mr-3"></i> Contact Us</a>
    </nav>

    <div class="mt-auto px-4 pb-4">
        <a href="index.html" class="nav-link text-red-400"><i class="fas fa-sign-out-alt mr-3"></i> Logout</a>
    </div>
</aside>
